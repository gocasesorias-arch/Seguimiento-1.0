<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Seguimiento de Capacitaciones</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <div id="root"></div>

    <!-- Cargar datos -->
    <script src="cursos_data_inline.js"></script>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function App() {
            const [cursos, setCursos] = useState([]);
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(null);

            useEffect(() => {
                console.log('Verificando datos...');
                console.log('window.cursosData existe?', typeof window.cursosData !== 'undefined');
                console.log('Es array?', Array.isArray(window.cursosData));
                console.log('Cantidad:', window.cursosData ? window.cursosData.length : 0);

                if (window.cursosData && Array.isArray(window.cursosData)) {
                    // Saltar el primer elemento que es el header
                    const data = window.cursosData.slice(1);
                    setCursos(data);
                    setLoading(false);
                    console.log('✓ Datos cargados:', data.length, 'cursos');
                } else {
                    setError('No se encontraron datos');
                    setLoading(false);
                    console.error('✗ No hay datos disponibles');
                }
            }, []);

            if (loading) {
                return (
                    <div className="min-h-screen flex items-center justify-center">
                        <div className="text-center">
                            <div className="animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"></div>
                            <p className="text-xl">Cargando datos...</p>
                        </div>
                    </div>
                );
            }

            if (error) {
                return (
                    <div className="min-h-screen flex items-center justify-center">
                        <div className="bg-white rounded-lg shadow-lg p-8 max-w-md">
                            <h2 className="text-2xl font-bold text-red-600 mb-4">Error</h2>
                            <p className="text-gray-700">{error}</p>
                            <button
                                onClick={() => window.location.reload()}
                                className="mt-4 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"
                            >
                                Recargar
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="container mx-auto p-4">
                    <div className="bg-white rounded-lg shadow-lg p-6">
                        <h1 className="text-3xl font-bold text-blue-900 mb-6">
                            Sistema de Seguimiento de Capacitaciones
                        </h1>

                        <div className="mb-4 p-4 bg-green-100 rounded">
                            <p className="text-green-800 font-semibold">
                                ✓ Datos cargados exitosamente: {cursos.length} cursos
                            </p>
                        </div>

                        <div className="overflow-x-auto">
                            <table className="min-w-full bg-white border">
                                <thead className="bg-gray-100">
                                    <tr>
                                        <th className="px-4 py-2 border">ID</th>
                                        <th className="px-4 py-2 border">Año</th>
                                        <th className="px-4 py-2 border">Estado</th>
                                        <th className="px-4 py-2 border">Gerencia</th>
                                        <th className="px-4 py-2 border">VP</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {cursos.slice(0, 20).map((curso, index) => (
                                        <tr key={index} className="hover:bg-gray-50">
                                            <td className="px-4 py-2 border text-sm">{curso["ID POWERBI"] || '-'}</td>
                                            <td className="px-4 py-2 border text-center">{curso["Año"] || '-'}</td>
                                            <td className="px-4 py-2 border">
                                                <span className={`px-2 py-1 rounded text-xs ${
                                                    curso["Estado Actividad"] === "Realizado" ? "bg-green-200 text-green-800" :
                                                    curso["Estado Actividad"] === "En Ejecución" ? "bg-blue-200 text-blue-800" :
                                                    curso["Estado Actividad"] === "Planificado" ? "bg-yellow-200 text-yellow-800" :
                                                    "bg-gray-200 text-gray-800"
                                                }`}>
                                                    {curso["Estado Actividad"] || 'Pendiente'}
                                                </span>
                                            </td>
                                            <td className="px-4 py-2 border text-sm">{curso["Gerencia"] || '-'}</td>
                                            <td className="px-4 py-2 border text-sm">{curso["VP"] || '-'}</td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>

                        {cursos.length > 20 && (
                            <p className="mt-4 text-gray-600 text-center">
                                Mostrando 20 de {cursos.length} cursos
                            </p>
                        )}
                    </div>
                </div>
            );
        }

        // Renderizar
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
